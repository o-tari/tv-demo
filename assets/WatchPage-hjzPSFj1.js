import{u as F,a as B,o as Ce,p as ee,q as Te,v as Pe,w as Ee,j as e,x as Le,s as Re,t as Ae,y as Me,m as Se,z as Ve}from"./index-B7Om342z.js";import{r as a,u as ge,L as Ie,e as ze}from"./router-LUHdcDgl.js";import{a as te,b as De}from"./formatNumber-CanhB8v4.js";import{f as _e}from"./formatTime-BiH8Yqa9.js";import"./vendor-gH-7aFTg.js";import"./redux-uMWmO1IK.js";import"./utils-COe-vthL.js";const He=r=>{const c=F(),m=a.useRef(new Set),{currentVideo:n,currentVideoLoading:f,currentVideoError:d,relatedVideos:o}=B(x=>x.videos),i=a.useMemo(()=>o[r]||{videos:[],loading:!1,error:null,nextPageToken:null},[o,r]);a.useEffect(()=>{r&&(n?.id!==r&&c(Ce(r)),!i.videos.length&&!i.loading&&!m.current.has(r)&&(m.current.add(r),c(ee({videoId:r})).finally(()=>{m.current.delete(r)})))},[c,r,n?.id,i.videos.length,i.loading]),a.useEffect(()=>()=>{m.current.delete(r)},[r]);const v=()=>{r&&!i.loading&&c(ee({videoId:r,pageToken:i.nextPageToken||void 0}))},s=()=>{r&&c(ee({videoId:r}))};return{video:n,loading:f,error:d,relatedVideos:i.videos,relatedLoading:i.loading,relatedError:i.error,loadMoreRelated:v,retryRelatedVideos:s}},S={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},h=(r,c)=>{const m=f=>{try{return JSON.stringify(f,(d,o)=>{if(typeof o=="object"&&o!==null){if(o.constructor&&o.constructor.name==="HTMLDivElement")return"[HTMLDivElement]";if(o.constructor&&o.constructor.name==="FiberNode")return"[FiberNode]";if(d&&typeof o=="object"){const i=new WeakSet;if(i.has(o))return"[Circular]";i.add(o)}}return o})}catch{return"[Object - Circular Reference]"}};console.log(` YouTube Event: ${r}`,c||"");const n=document.getElementById("youtube-event-log");if(n){const f=new Date().toLocaleTimeString(),d=document.createElement("div");for(d.className="text-xs text-gray-500 border-b border-gray-200 py-1",d.innerHTML=`<span class="font-mono">[${f}]</span> ${r}${c?` - ${m(c)}`:""}`,n.appendChild(d);n.children.length>50;)n.removeChild(n.firstChild);n.scrollTop=n.scrollHeight}},Oe=({videoId:r,video:c,onReady:m,onStateChange:n,onVideoEnd:f,showControls:d=!0,autoplay:o=!1,fullWindow:i=!1})=>{const v=a.useRef(null),s=a.useRef(null),x=F(),T=B(Te(r)),[g,k]=a.useState(!1),[N,y]=a.useState(0),[j,M]=a.useState(0),[C,L]=a.useState(50),[w,z]=a.useState(!1),[re,$]=a.useState(1),[ae,U]=a.useState(""),[se,he]=a.useState([]),[Q,me]=a.useState(!1),[E,xe]=a.useState(!1),[fe,pe]=a.useState(!1),[ye,D]=a.useState(!1),[be,ve]=a.useState(!1),[_,je]=a.useState(!1),[W,ne]=a.useState(!1),[H,G]=a.useState(!1),[q,R]=a.useState(null),[le,P]=a.useState(!1);a.useEffect(()=>{G(!1),ne(!1),R(null),P(!1)},[r]),a.useEffect(()=>{if(window.YT){k(!0);return}let t,l=null;return(()=>{l=document.createElement("script"),l.src="https://www.youtube.com/iframe_api",l.async=!0,l.onerror=()=>{console.error("Failed to load YouTube IFrame API"),h("API_LOAD_ERROR"),k(!1)},document.head.appendChild(l),t=setTimeout(()=>{console.warn("YouTube IFrame API loading timeout"),h("API_LOAD_TIMEOUT"),k(!1)},1e4),window.onYouTubeIframeAPIReady=()=>{clearTimeout(t),h("API_READY"),k(!0)}})(),()=>{t&&clearTimeout(t),l&&l.parentNode&&l.parentNode.removeChild(l),typeof window.onYouTubeIframeAPIReady=="function"&&(window.onYouTubeIframeAPIReady=void 0)}},[]),a.useEffect(()=>{(()=>{const l="pictureInPictureEnabled"in document;console.log("Picture-in-Picture support check:",l),je(l)})()},[g]),a.useEffect(()=>{const t=()=>{ve(!!document.pictureInPictureElement)};return _&&(document.addEventListener("enterpictureinpicture",t),document.addEventListener("leavepictureinpicture",t)),()=>{document.removeEventListener("enterpictureinpicture",t),document.removeEventListener("leavepictureinpicture",t)}},[_]),a.useEffect(()=>{if(!g||!v.current||!r)return;const l=setTimeout(()=>{try{P(!0),R(null),s.current&&s.current.destroy(),h("PLAYER_INITIALIZING",{videoId:r});const p={height:"100%",width:"100%",videoId:r,playerVars:{autoplay:o?1:0,controls:1,modestbranding:1,rel:0,showinfo:0,iv_load_policy:3,fs:1,cc_load_policy:0,playsinline:1},events:{onReady:b=>{try{h("PLAYER_READY",b),P(!1);const u=b.target,I=u.getDuration(),A=u.getVolume(),de=u.getPlaybackRate();M(I),L(A),$(de);const ue=u.getAvailableQualityLevels();he(ue),U(u.getPlaybackQuality()),h("PLAYER_INITIAL_STATE",{duration:I,volume:A,playbackRate:de,qualities:ue,currentQuality:u.getPlaybackQuality()}),m?.()}catch(u){console.error("Error in onReady callback:",u),R("Failed to initialize player"),P(!1)}},onStateChange:b=>{const u=b.data,I=Object.keys(S).find(A=>S[A]===u)||"UNKNOWN";h("STATE_CHANGE",{state:u,stateName:I,currentTime:s.current?.getCurrentTime()||0,duration:s.current?.getDuration()||0}),xe(u===S.PLAYING),pe(u===S.BUFFERING),u===S.ENDED&&(h("VIDEO_ENDED"),console.log(" EnhancedYouTubePlayer: Video ended, calling onVideoEnd"),f?.()),n?.(u),x(Le({isPlaying:u===S.PLAYING,duration:s.current?.getDuration()||0}))},onPlaybackQualityChange:b=>{const u=b.data;h("QUALITY_CHANGE",{quality:u}),U(String(u))},onPlaybackRateChange:b=>{const u=b.data;h("PLAYBACK_RATE_CHANGE",{rate:u}),$(u)},onError:b=>{const u=b.data,A={2:"Invalid video ID",5:"HTML5 player error",100:"Video not found or private",101:"Video not allowed in embedded players",150:"Video not allowed in embedded players"}[u]||"Unknown error";R(A),P(!1),h("ERROR",{error:u,message:A})},onApiChange:b=>{h("API_CHANGE",b)},onVolumeChange:()=>{const b=s.current?.getVolume()||0,u=s.current?.isMuted()||!1;h("VOLUME_CHANGE",{volume:b,isMuted:u}),L(b),z(u)}}};v.current&&(s.current=new window.YT.Player(v.current,p))}catch(p){console.error("Error initializing YouTube player:",p),R("Failed to create player instance"),P(!1)}},100);return()=>{clearTimeout(l),P(!1)}},[g,r,x,m,n,f,o]),a.useEffect(()=>{if(s.current&&T>0&&!H){const t=s.current.getDuration();if(t>0){const l=t-5,p=Math.min(T,l);p>5?(console.log(` Resuming video from ${p.toFixed(1)}s (${(p/t*100).toFixed(1)}%)`),setTimeout(()=>{s.current&&(s.current.seekTo(p,!0),y(p),G(!0))},200)):(console.log(" Saved progress too close to start/end, starting from beginning"),G(!0))}}},[T,H]),a.useEffect(()=>{if(!E||!s.current)return;const t=setInterval(()=>{const l=s.current?.getCurrentTime()||0,p=s.current?.getDuration()||0;y(l),(H?l-T:l)>=10&&!W&&(ne(!0),c&&x(Pe({video:c,currentTime:l,duration:p}))),c&&W&&p>0&&x(Ee({videoId:c.id,currentTime:l,duration:p}))},1e3);return()=>clearInterval(t)},[E,W,c,x,H,T]);const oe=a.useCallback(()=>{s.current&&(h("CONTROL_PLAY"),s.current.playVideo())},[]),ie=a.useCallback(()=>{s.current&&(h("CONTROL_PAUSE"),s.current.pauseVideo())},[]),K=a.useCallback(()=>{E?ie():oe()},[E,oe,ie]),V=a.useCallback(t=>{s.current&&(h("CONTROL_SEEK",{seconds:t}),s.current.seekTo(t,!0))},[]),J=t=>{s.current&&(h("CONTROL_VOLUME",{volume:t}),s.current.setVolume(t),L(t))},X=a.useCallback(()=>{s.current&&(w?(h("CONTROL_UNMUTE"),s.current.unMute()):(h("CONTROL_MUTE"),s.current.mute()),z(!w))},[w]),ke=t=>{s.current&&(h("CONTROL_PLAYBACK_RATE",{rate:t}),s.current.setPlaybackRate(t),$(t))},Ne=t=>{s.current&&(h("CONTROL_QUALITY",{quality:t}),s.current.setPlaybackQuality(t),U(t))},Z=a.useCallback(()=>{if(s.current){h("CONTROL_FULLSCREEN",{isFullscreen:!Q});const t=s.current.getIframe();t&&(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),me(!Q))}},[Q]),we=async()=>{try{if(!_){console.warn("Picture-in-Picture is not supported in this browser"),alert("Picture-in-Picture is not supported in this browser.");return}alert(`Picture-in-Picture is not available for YouTube videos due to browser security restrictions. You can use the browser's native Picture-in-Picture feature by right-clicking on the video and selecting "Picture in Picture" from the context menu.`),h("CONTROL_PIP",{action:"info_shown"})}catch(t){console.error("Picture-in-Picture error:",t),h("CONTROL_PIP_ERROR",{error:t instanceof Error?t.message:String(t)})}},O=a.useCallback(()=>{const t=Math.max(0,N-10);V(t)},[N,V]),Y=a.useCallback(()=>{const t=Math.min(j,N+10);V(t)},[N,j,V]),ce=t=>{const l=Math.floor(t/60),p=Math.floor(t%60);return`${l}:${p.toString().padStart(2,"0")}`};return a.useEffect(()=>{const t=l=>{if(!(l.target instanceof HTMLInputElement||l.target instanceof HTMLTextAreaElement))switch(l.key.toLowerCase()){case"k":case" ":l.preventDefault(),K();break;case"j":l.preventDefault(),O();break;case"l":l.preventDefault(),Y();break;case"f":l.preventDefault(),Z();break;case"m":l.preventDefault(),X();break;case"arrowleft":l.preventDefault(),O();break;case"arrowright":l.preventDefault(),Y();break;case"arrowup":l.preventDefault(),J(Math.min(100,C+10));break;case"arrowdown":l.preventDefault(),J(Math.max(0,C-10));break;case"escape":D(p=>p&&(l.preventDefault(),!1));break}};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[E,N,j,C,w,O,Y,Z,X,K]),e.jsxs("div",{className:i?"h-full":"space-y-4",children:[e.jsxs("div",{className:`relative w-full bg-black overflow-hidden ${i?"h-full":"aspect-video rounded-lg"}`,children:[e.jsx("div",{ref:v,className:"w-full h-full"}),(!g||le)&&!q&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-2"}),e.jsx("p",{children:le?"Initializing player...":"Loading YouTube API..."})]})}),q&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:e.jsxs("div",{className:"text-white text-center p-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-600 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Player Error"}),e.jsx("p",{className:"text-gray-300 mb-4",children:q}),e.jsx("button",{onClick:()=>{R(null),P(!1),window.YT&&v.current&&r&&setTimeout(()=>{(()=>{s.current&&s.current.destroy(),s.current=new window.YT.Player(v.current,{height:"100%",width:"100%",videoId:r,playerVars:{autoplay:o?1:0,controls:1,modestbranding:1,rel:0,showinfo:0,iv_load_policy:3,fs:1,cc_load_policy:0,playsinline:1},events:{onReady:()=>{P(!1),m?.()},onStateChange:()=>{},onPlaybackQualityChange:()=>{},onPlaybackRateChange:()=>{},onError:()=>{R("Failed to load video"),P(!1)},onApiChange:()=>{},onVolumeChange:()=>{}}})})()},100)},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Retry"})]})})]}),d&&g&&!i&&e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:ce(N)}),e.jsxs("div",{className:"flex-1 bg-gray-300 dark:bg-gray-600 rounded-full h-2 relative",children:[e.jsx("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-200",style:{width:`${j>0?N/j*100:0}%`}}),e.jsx("input",{type:"range",min:"0",max:j||0,value:N,onChange:t=>V(parseFloat(t.target.value)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsx("span",{children:ce(j)})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:K,className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:E?"Pause":"Play",children:E?e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:O,className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:"Skip backward 10s",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M8.445 14.832A1 1 0 0010 14v-2.798l5.445 3.63A1 1 0 0017 14V6a1 1 0 00-1.555-.832L10 8.798V6a1 1 0 00-1.555-.832l-6 4a1 1 0 000 1.664l6 4z"})})}),e.jsx("button",{onClick:Y,className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:"Skip forward 10s",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M4.555 5.168A1 1 0 003 6v8a1 1 0 001.555.832L10 11.202V14a1 1 0 001.555.832l6-4a1 1 0 000-1.664l-6-4A1 1 0 0010 6v2.798l-5.445-3.63z"})})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:X,className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:w?"Unmute":"Mute",children:w?e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L5.293 13H3a1 1 0 01-1-1V8a1 1 0 011-1h2.293l3.09-3.793a1 1 0 011.617.793zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z",clipRule:"evenodd"})}):e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L5.293 13H3a1 1 0 01-1-1V8a1 1 0 011-1h2.293l3.09-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})})}),e.jsx("input",{type:"range",min:"0",max:"100",value:C,onChange:t=>J(parseInt(t.target.value)),className:"w-20",title:`Volume: ${C}%`}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 w-8",children:[C,"%"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Speed:"}),e.jsxs("select",{value:re,onChange:t=>ke(parseFloat(t.target.value)),className:"text-sm bg-gray-200 dark:bg-gray-700 rounded px-2 py-1",children:[e.jsx("option",{value:.25,children:"0.25x"}),e.jsx("option",{value:.5,children:"0.5x"}),e.jsx("option",{value:.75,children:"0.75x"}),e.jsx("option",{value:1,children:"1x"}),e.jsx("option",{value:1.25,children:"1.25x"}),e.jsx("option",{value:1.5,children:"1.5x"}),e.jsx("option",{value:1.75,children:"1.75x"}),e.jsx("option",{value:2,children:"2x"})]})]}),se.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Quality:"}),e.jsx("select",{value:ae,onChange:t=>Ne(t.target.value),className:"text-sm bg-gray-200 dark:bg-gray-700 rounded px-2 py-1",children:se.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx("button",{onClick:()=>D(!0),className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:"View event logs",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 000 2h1.5a1 1 0 000-2H3zm0 4a1 1 0 000 2h1.5a1 1 0 000-2H3zm0 4a1 1 0 000 2h1.5a1 1 0 000-2H3zm4-8a1 1 0 000 2h1.5a1 1 0 000-2H7zm0 4a1 1 0 000 2h1.5a1 1 0 000-2H7zm0 4a1 1 0 000 2h1.5a1 1 0 000-2H7zm4-8a1 1 0 000 2h1.5a1 1 0 000-2h-1.5zm0 4a1 1 0 000 2h1.5a1 1 0 000-2h-1.5zm0 4a1 1 0 000 2h1.5a1 1 0 000-2h-1.5z",clipRule:"evenodd"})})}),_&&e.jsx("button",{onClick:we,className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:be?"Exit Picture-in-Picture":"Enter Picture-in-Picture",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M2 4a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H3a1 1 0 01-1-1V4zm0 6a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H3a1 1 0 01-1-1v-2zm6-6a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H9a1 1 0 01-1-1V4zm0 6a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H9a1 1 0 01-1-1v-2zm6-6a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1V4zm0 6a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1v-2z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:Z,className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:"Toggle fullscreen",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 11-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15 13.586V12a1 1 0 011-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Status: ",fe?"Buffering...":E?"Playing":"Paused"]}),e.jsxs("span",{children:["Quality: ",ae]}),e.jsxs("span",{children:["Speed: ",re,"x"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{children:"Keyboard shortcuts: K/Space (play/pause), J/L (skip), M (mute), F (fullscreen), Esc (close logs)"})})]})]}),ye&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>D(!1),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"YouTube Events Log"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{const t=document.getElementById("youtube-event-log");t&&(t.innerHTML='<div class="text-gray-500">Events will appear here...</div>')},className:"px-3 py-1 text-sm bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Clear"}),e.jsx("button",{onClick:()=>D(!1),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{id:"youtube-event-log",className:"h-full overflow-y-auto text-xs font-mono bg-gray-50 dark:bg-gray-900 p-4",children:e.jsx("div",{className:"text-gray-500",children:"Events will appear here..."})})}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("p",{children:"This log shows all YouTube IFrame Player API events in real-time."}),e.jsx("p",{children:"Use the Clear button to reset the log, or close this modal to continue watching."})]})})]})})]})},Ye=r=>{if(!r)return"";const c=document.createElement("div");c.innerHTML=r;const m=["p","br","strong","b","em","i","u","s","strike","del","a","span","div","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","pre","code"],n=["href","target","rel","class","id"],f=o=>{if(o.nodeType===Node.TEXT_NODE)return o;if(o.nodeType===Node.ELEMENT_NODE){const i=o,v=i.tagName.toLowerCase();if(!m.includes(v)){const g=i.parentNode;if(g){for(;i.firstChild;)g.insertBefore(i.firstChild,i);g.removeChild(i)}return null}Array.from(i.attributes).forEach(g=>{n.includes(g.name)||i.removeAttribute(g.name)});const x=i.getAttribute("href");x&&!Fe(x)&&i.removeAttribute("href"),Array.from(i.childNodes).forEach(g=>{const k=f(g);k&&k!==g&&i.replaceChild(k,g)})}return o};return Array.from(c.childNodes).forEach(o=>{f(o)}),c.innerHTML},Fe=r=>{try{const c=new URL(r);return c.protocol==="http:"||c.protocol==="https:"}catch{return!1}},Be=({video:r})=>{const c=ge(),m=F(),n=B(Re(r.channelId)),[f,d]=a.useState(!1),[o,i]=a.useState(!1),v=g=>{const k=new Date,N=new Date(g),y=Math.floor((k.getTime()-N.getTime())/1e3);return y<60?"Just now":y<3600?`${Math.floor(y/60)} minutes ago`:y<86400?`${Math.floor(y/3600)} hours ago`:y<2592e3?`${Math.floor(y/86400)} days ago`:y<31536e3?`${Math.floor(y/2592e3)} months ago`:`${Math.floor(y/31536e3)} years ago`},s=()=>{i(!o)},x=()=>{const g={id:r.channelId,title:r.channelTitle,description:"",thumbnail:`https://ui-avatars.com/api/?name=${encodeURIComponent(r.channelTitle)}&background=random`,subscriberCount:"0",videoCount:"0",viewCount:"0"};m(Ae(g))},T=()=>{c(`/channel/${r.channelId}`)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r.title}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:te(r.viewCount)}),e.jsx("span",{children:"•"}),e.jsx("span",{children:v(r.publishedAt)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:s,className:`flex items-center space-x-2 px-4 py-2 rounded-full transition-colors ${o?"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white":"hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:o?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),e.jsx("span",{children:"Save"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),e.jsx("span",{children:"Share"})]})]})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("button",{onClick:T,className:"flex items-start space-x-3 flex-1 min-w-0 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg p-2 -m-2 transition-colors group",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(r.channelTitle)}&background=random`,alt:r.channelTitle,className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white group-hover:text-red-600 dark:group-hover:text-red-400",children:r.channelTitle}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[te(r.viewCount)," subscribers"]})]})]}),e.jsx("button",{onClick:x,className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${n?"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white":"bg-red-600 hover:bg-red-700 text-white"}`,children:n?"Subscribed":"Subscribe"})]})}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.jsxs("span",{children:[te(r.viewCount)," views"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:v(r.publishedAt)})]}),e.jsx("div",{className:`text-sm text-gray-900 dark:text-white ${f?"":"line-clamp-3"}`,dangerouslySetInnerHTML:{__html:Ye(r.description)}}),r.description.length>200&&e.jsx("button",{onClick:()=>d(!f),className:"text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mt-2 font-medium",children:f?"Show less":"Show more"})]})})]})},$e=({videos:r,loading:c,error:m,onRetry:n,title:f="Related Videos"})=>c?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:Array.from({length:8}).map((d,o)=>e.jsxs("div",{className:"flex flex-col space-y-2 animate-pulse",children:[e.jsx("div",{className:"w-full aspect-video bg-gray-200 dark:bg-gray-700 rounded-lg"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/4"})]})]},o))}):m?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm mb-2",children:"Failed to load related videos"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs mb-3",children:m}),n&&e.jsx("button",{onClick:n,className:"btn-primary text-sm",children:"Try again"})]}):r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"No related videos found"})]}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:f}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:r.map(d=>e.jsx(Ie,{to:`/watch/${d.id}`,className:"block group",children:e.jsxs("div",{className:"flex flex-col space-y-2 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg p-2 transition-colors",children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden",children:[e.jsx("img",{src:d.thumbnail,alt:d.title,className:"w-full h-full object-cover transition-opacity duration-300 group-hover:opacity-90",onError:o=>{const i=o.target;i.src="/placeholder-movie.svg"}}),d.duration&&e.jsx("span",{className:"absolute bottom-1 right-1 bg-black bg-opacity-80 text-white text-xs px-1 py-0.5 rounded",children:_e(d.duration)})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white group-hover:text-red-600 dark:group-hover:text-red-400 line-clamp-2",children:d.title}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:d.channelTitle}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400",children:[d.viewCount&&e.jsxs("span",{children:[De(parseInt(d.viewCount))," views"]}),d.publishedAt&&e.jsx("span",{children:"•"}),d.publishedAt&&e.jsx("span",{children:new Date(d.publishedAt).toLocaleDateString()})]})]})]})},d.id))})]}),Xe=()=>{const{videoId:r}=ze(),c=ge(),m=F(),{video:n,loading:f,error:d,relatedVideos:o,relatedLoading:i,relatedError:v,retryRelatedVideos:s}=He(r||""),{autoplay:x}=B(j=>j.ui);a.useEffect(()=>{n&&m(Me(n))},[m,n]);const T=a.useCallback(async()=>{if(console.log(" Video ended! Checking for auto-play..."),console.log("autoplay enabled:",x),console.log("current videoId:",r),console.log("current video:",n),x&&n)try{console.log(" Video ended, searching for similar videos with title:",n.title),console.log(" Using category ID:",n.categoryId);const j={type:"video",excludeShorts:!0,...n.categoryId&&{categoryId:n.categoryId}},M=await m(Se({query:n.title,filters:j}));if(M.payload&&M.payload.items&&M.payload.items.length>0){const C=M.payload.items.filter(L=>L.id!==r);if(console.log("Available search results after filtering:",C.length),C.length>0){const L=Math.floor(Math.random()*C.length),w=C[L];if(w&&w.id){console.log(" Video ended, navigating to random similar video:",w.title);const z=`Auto-playing: ${w.title}`;console.log(z),setTimeout(()=>{c(`/watch/${w.id}`)},500)}else console.log(" Video ended, but no valid similar videos available")}else console.log(" Video ended, but no other similar videos available")}else console.log(" Video ended, but no search results found")}catch(j){console.error(" Error searching for similar videos:",j)}else x?n||console.log(" Video ended, but no video details available"):console.log(" Video ended, but autoplay is disabled - staying on current video")},[x,n,r,c,m]),g=f,k=d,[N,y]=a.useState(!1);return a.useEffect(()=>{if(g){const j=setTimeout(()=>{y(!0)},15e3);return()=>clearTimeout(j)}else y(!1)},[g]),g&&!N?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"aspect-video bg-gray-200 dark:bg-gray-700 rounded-lg mb-6"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4"})]})]})})}):N?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-yellow-100 dark:bg-yellow-900 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-12 h-12 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Loading Timeout"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"The content is taking longer than expected to load. This might be due to network issues or API problems."}),e.jsxs("div",{className:"space-x-4",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Reload Page"}),e.jsx("button",{onClick:()=>c(-1),className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Go Back"})]})]}):k?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-12 h-12 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Video not found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:k}),e.jsx("button",{onClick:()=>window.history.back(),className:"btn-primary",children:"Go back"})]}):n?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"relative full-window-player",children:[e.jsx("button",{onClick:()=>c(-1),className:"absolute top-4 left-4 z-10 p-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white rounded-full transition-all duration-200",title:"Go back",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx(Oe,{videoId:n.id,video:n,showControls:!0,onVideoEnd:T,autoplay:x,fullWindow:!0})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:()=>m(Ve()),className:"w-4 h-4 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500 dark:focus:ring-red-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Autoplay videos"})]})}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:x?"Videos will start playing automatically":"Videos will not autoplay"})]})}),e.jsx(Be,{video:n}),e.jsx("div",{className:"w-full",children:e.jsx($e,{videos:o,loading:i,error:v,onRetry:s,title:"Videos similar to this one"})})]})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Video not found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"The video you're looking for doesn't exist or has been removed."})]})};export{Xe as default};
